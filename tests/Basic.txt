*** Settings ***
Documentation     This series of test cases evaluates the basic environment setup and the ability to parse basic documents.
Library           Process
Library           OperatingSystem
Library           XML

*** Test Cases ***
000 Environment
    ${result} =    Run Process    ../tools/gennlm.sh 001.docx ./000    shell=True
    Log    ${result.stdout}
    Log    ${result.stderr}
    Should Not Contain    ${result.stderr}    cannot find or open
    Should Not Contain    ${result.stdout}    ERROR
    [Teardown]    Remove Directory    000    recursive=True

001 Basic paragraph
    ${result} =    Run Process    ../tools/gennlm.sh 001.docx ./001    shell=True
    Log    ${result.stdout}
    Log    ${result.stderr}
    ${xml}=    Parse XML    ./001/001.xml
    ${paragraph}=    Get Element    ${xml}    body/sec/p
    Elements Should Match    ${paragraph}    <p>The most basic document possible.</p>
    [Teardown]    Remove Directory    001    recursive=True

002 Basic paragraph with italics
    ${result} =    Run Process    ../tools/gennlm.sh 002.docx ./002    shell=True
    Log    ${result.stdout}
    Log    ${result.stderr}
    ${xml}=    Parse XML    ./002/002.xml
    ${paragraph}=    Get Element    ${xml}    body/sec/p
    Elements Should Match    ${paragraph}    <p>A document <italic>with</italic> an italic word.</p>
    [Teardown]    Remove Directory    002    recursive=True

003 Metadata merge
    ${result} =    Run Process    ../tools/gennlm.sh 002.docx ./002    shell=True
    Log    ${result.stdout}
    Log    ${result.stderr}
    ${xml}=    Parse XML    ./002/002.xml
    ${paragraph}=    Get Element    ${xml}    body/sec/p
    Elements Should Match    ${paragraph}    <p>A document <italic>with</italic> an italic word.</p>
    [Teardown]    Remove Directory    002    recursive=True
