*** Settings ***
Documentation     This series of test cases evaluates the sizeClassifier and section positioning
Library           Process
Library           OperatingSystem
Library           XML
Library           Collections

*** Test Cases ***
617 Positional Stack H20 -> H19 -> H18 -> H20 -> H18 (a case that demonstrates the need for the positional stack)
    [Tags]    sectionheaders    sizeclassifier
    #evaluates:
    #<body>
    #<sec>
    #<title>Heading 20</title>
    #<p>Text under heading 20</p>
    #<p>Line 2 under heading 20</p>
    #<sec>
    #<title>Heading 19</title>
    #<p>Text under heading 19</p>
    #<p>Line 2 under heading 19</p>
    #<sec>
    #<title>Heading 18</title>
    #<p>Text under heading 18</p>
    #<p>Line 2 under heading 18</p>
    #</sec>
    #</sec>
    #</sec>
    #<sec>
    #<title>Heading 20</title>
    #<p>Text under heading 20</p>
    #<p>Line 2 under heading 20</p>
    #<sec>
    #<title>Heading 18</title>
    #<p>Text under heading 18</p>
    #<p>Line 2 under heading 18</p>
    #</sec>
    #</sec>
    #</body>
    ${result} =    Run Process    python ../bin/meTypeset.py -d Sec005.docx -o ./617    shell=True
    Log    ${result.stdout}
    Log    ${result.stderr}
    ${xml}=    Parse XML    ./617/nlm/out.xml
    ${sections}=    Get Elements    ${xml}    body/sec
    ${firstsection}=    Get from list    ${sections}    0
    ${firstsectiontitle}=    Get Element    ${firstsection}    title
    ${firstsectionparagraphs}=    Get Elements    ${firstsection}    p
    ${paraone}=    Get from list    ${firstsectionparagraphs}    0
    ${paratwo}=    Get from list    ${firstsectionparagraphs}    1
    Elements Should Match    ${firstsectiontitle}    <title>Heading 20</title>
    Elements Should Match    ${paraone}    <p>Text under heading 20</p>
    Elements Should Match    ${paratwo}    <p>Line 2 under heading 20</p>
    ${firstsub} =    Get Elements    ${xml}    body/sec/sec
    ${firstsubsection} =    Get from list    ${firstsub}    0
    ${secondtitle}=    Get Element    ${firstsubsection}    title
    ${secondsectionparagraphs}=    Get Elements    ${firstsubsection}    p
    ${parathree}=    Get from list    ${secondsectionparagraphs}    0
    ${parafour}=    Get from list    ${secondsectionparagraphs}    1
    Elements Should Match    ${secondtitle}    <title>Heading 19</title>
    Elements Should Match    ${parathree}    <p>Text under heading 19</p>
    Elements Should Match    ${parafour}    <p>Line 2 under heading 19</p>
    ${secondsub} =    Get Elements    ${xml}    body/sec/sec/sec
    ${secondsubsection} =    Get from list    ${secondsub}    0
    ${thirdtitle}=    Get Element    ${secondsubsection}    title
    ${thirdsectionparagraphs}=    Get Elements    ${secondsubsection}    p
    ${parafive}=    Get from list    ${thirdsectionparagraphs}    0
    ${parasix}=    Get from list    ${thirdsectionparagraphs}    1
    Elements Should Match    ${thirdtitle}    <title>Heading 18</title>
    Elements Should Match    ${parafive}    <p>Text under heading 18</p>
    Elements Should Match    ${parasix}    <p>Line 2 under heading 18</p>
    ${thirdsection}=    Get from list    ${sections}    1
    ${fourthsectiontitle}=    Get Element    ${thirdsection}    title
    ${fourthsectionparagraphs}=    Get Elements    ${thirdsection}    p
    ${paraseven}=    Get from list    ${fourthsectionparagraphs}    0
    ${paraeight}=    Get from list    ${fourthsectionparagraphs}    1
    Elements Should Match    ${fourthsectiontitle}    <title>Heading 20</title>
    Elements Should Match    ${paraseven}    <p>Text under heading 20</p>
    Elements Should Match    ${paraeight}    <p>Line 2 under heading 20</p>
    ${thirdsubsection} =    Get from list    ${firstsub}    1
    ${fifthtitle}=    Get Element    ${thirdsubsection}    title
    ${fifthsectionparagraphs}=    Get Elements    ${thirdsubsection}    p
    ${paranine}=    Get from list    ${fifthsectionparagraphs}    0
    ${paraten}=    Get from list    ${fifthsectionparagraphs}    1
    Elements Should Match    ${fifthtitle}    <title>Heading 18</title>
    Elements Should Match    ${paranine}    <p>Text under heading 18</p>
    Elements Should Match    ${paraten}    <p>Line 2 under heading 18</p>
    [Teardown]    Remove Directory    617    recursive=True
