*** Settings ***
Documentation     This series of test cases evaluates meTypeset's ability to handle various aspects of scholarly referencing
Library           Process
Library           OperatingSystem
Library           XML
Library           Collections

*** Test Cases ***
R01 Simple Inline Reference
    [Tags]    references    inline    R01
    ${result} =    Run Process    python ../bin/meTypeset.py docx SimpleInline.docx ./Inline -d    shell=True
    Log    ${result.stdout}
    Log    ${result.stderr}
    ${xml}=    Parse XML    ./Inline/nlm/out.xml
    ${paragraph}=    Get Element    ${xml}    body/sec/p/xref
    Should Be Equal As Strings    ${paragraph.text}    Eve 2012
    [Teardown]    Remove Directory    Inline    recursive=True

R02 Year detection method
    [Tags]    references    ref-list    R02
    ${result} =    Run Process    python ../bin/meTypeset.py docx R02.docx -s testsettings.xml ./R02 -d    shell=True
    Log    ${result.stdout}
    Log    ${result.stderr}
    ${xml}=    Parse XML    ./R02/nlm/out.xml
    ${paragraph}=    Get Element    ${xml}    back/ref-list
    Elements Should Match    ${paragraph}    <ref-list><ref id="1">Eve, Martin Paul, <italic>Pynchon and Philosophy</italic> (London: Palgrave MacMillan, 2014)</ref><ref id="2">Thomas, Samuel, <italic>Pynchon and the Political </italic>(New York: Routledge, 2007)</ref></ref-list>    normalize_whitespace=yes
    [Teardown]    Remove Directory    R02    recursive=True
